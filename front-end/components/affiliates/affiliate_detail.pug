extends /site/detail

block instance
    -
        page.data({
            key: 'affiliate',
            title: 'affiliate',
            icon: "affiliates",
            impact_theme: "thm--affiliates",
            impact_color: "co--affiliates",
            
            location: 'affiliate_location',
            director_name: 'current_data.executive_director_name',
            director_email: 'current_data.executive_director_email',
            lead_name: 'current_data.program_lead_name',
            lead_email: 'current_data.program_lead_email',
        })


block premain
    include /posters/icon
        -
            vefa.data({ 
                    title: page.title.tag(),
                    icon: page.icon
            })
            .mixin({
                element: {
                    class: `thm--texture-tint ${page.impact_color}`,
                    "o-extended": "gxi--b"
                }
            })



block detail_a
    - 
        card_alt = {
            element: {
                "o-base": "col--pStart"
            },
            hdr: {
                "o-base": "pad--x25 pad--yEnd25",
                "o-condensed": "pad--x50"
            },
            hed: {
                class: "tx--subhed--f1--100--aa"
            },
            bd: {
                "o-base": ""
            },
            list: {
                "o-base": "mod--balance rhy--yStart25",
                "o-extended": "gx--i3--gxy10 mod--static rhy--yStart0"
            },
            data_hed: {
                class: `thm--shade60 tx--small--f3--900--aa`,
            },
            data_key: {
                class: "thm--shade40 tx--small--f3--tcU",
                "o-base": "pad--xy25",
                "o-condensed": "pad--xy50"
            },
            data_value: {
                class: "thm--tint10 tx--f3",
                "o-base": "col--pStart--sStart pad--xy25",
                "o-condensed": "pad--xy50 gxs--s2"
            },
        }

    include /cards/data-list
        -
            vefa
                .data({
                    heading: "Affiliate Details",
                    map: [
                        ["mixin", "Executive Director", "card_exec"],
                        ["mixin", "Program Lead", "card_lead"],
                        ["text", "Affiliate ID", page.cis_id.io()],
                        ["text", "Location", page.location.io(), page.location.tag("choice_display:'AffiliateLocation'", 'capfirst')],
                        ["mixin", "Address", "card_contact"],
                        ["text", "Phone Number", page.phone_number.io()],
                        ["text", "Fax Number", page.fax_number.io()],
                        ["link", "Website", page.website.io(), page.title.tag()],                            
                    ],
                    style: "alternate"
                })
                .define(card_alt)

        mixin card_contact
            ul
                li= page.address_street.tag()
                li= `${ page.address_city.tag() }, ${ page.address_state.tag() } ${ page.address_postcode.tag() }`
        
        mixin card_exec
            ul
                li= page.director_name.tag()
                li
                    a.tx--tdU.fx--shift(
                        href=`mailto:${ page.director_email.tag() }`
                    )
                        = page.director_email.tag()
        
        mixin card_lead
            ul
                li= page.lead_name.tag()
                li
                    a.tx--tdU.fx--shift(
                        href=`mailto:${ page.lead_email.tag() }`
                    )
                        = page.lead_email.tag()

    
    //- include /cards/data-list 
        -
            vefa
                .data({
                    heading: "CIS Services",
                    map: [
                        ['text', 'Academic Assistance'],
                        ['text', 'Basic Needs'],
                        ['text', 'Behavior Intervention'],
                        ['text', 'College/Career Prep'],
                        ['text', 'Community Service'],
                        ['text', 'Enrichment'],
                        ['text', 'Family Engagement'],
                        ['text', 'Life Skills/Social Development'],
                        ['text', 'Professional Mental Health'],
                        ['text', 'Professional Phytisal Health'],                         
                    ],
                    style: "alternate"
                })
                .define(card_alt)
                .mixin({
                    element: {
                        "o-condensed": "iso--yStart100"
                    }
                })

                        


block detail_b
    div(
        o-base="col--pStart rhy--yStart100"
    )
        include /cards/data-list
            -
                vefa
                    .data({
                        heading: "Affiliate Resources",
                        map: [
                            ["money", "Annual Budget", 'eoy_data.budget_total'],
                            ['money', 'Total Public Funding', 'eoy_data.funding_public'],
                            ['money', 'Total Private Funding', 'eoy_data.funding_private'],
                            //- ['text', 'Percent of Public Funding', page['current_data.funding_percent_public'].io(), `${ page['current_data.funding_percent_public'].tag() }%`],
                            //- ['text', 'Percent of Private Funding', page['current_data.funding_percent_private'].io(), `${ page['current_data.funding_percent_private'].tag() }%`],

                            ["heading", "Public Funding", 'eoy_data.funding_public'],
                            ['money', 'Federal', 'eoy_data.funding_public_federal'],
                            ['money', 'State', 'eoy_data.funding_public_state'],
                            ['money', 'City', 'eoy_data.funding_public_city'],
                            ['money', 'School District', 'eoy_data.funding_public_school_district'],
                            
                            ["heading", "Private Funding", 'eoy_data.funding_private'],
                            ['money', 'Corporate', 'eoy_data.funding_private_corporate'],
                            ['money', 'Foundation', 'eoy_data.funding_private_foundation'],
                            ['money', 'Board', 'eoy_data.funding_private_board'],
                            ['money', 'Individual', 'eoy_data.funding_private_individual'],
                            ['money', 'Events', 'eoy_data.funding_private_events'],
                            ['money', 'CIS National', 'eoy_data.funding_private_cis_national'],
                            ['money', 'CIS State Office', 'eoy_data.funding_private_cis_state_office'],
                            ['money', 'NPO', 'eoy_data.funding_private_npo'],
                            ['money', 'Other', 'eoy_data.funding_private_other'],
                        ]
                    })
        
        include /cards/data-list
            -
                vefa
                    .data({
                        heading: "Affiliate Performance",
                        map: [
                            ['heading', 'Students in Grades Kâ€”11', 'eoy_data.students_k_11_promoted'],
                            ['text', 'Promoted', 'eoy_data.students_k_11_promoted'],
                            ['text', 'Retained', 'eoy_data.students_k_11_retained'],
                            ['text', 'Dropped Out', 'eoy_data.students_k_11_dropped_out'],
                            ['text', 'Transferred', 'eoy_data.students_k_11_transferred'],
                            ['text', 'GED', 'eoy_data.students_k_11_ged'],
                            ['text', 'Expelled', 'eoy_data.students_k_11_expelled'],
                            ['text', 'Incarcerated', 'eoy_data.students_k_11_incarcerated'],
                            ['text', 'Deceased', 'eoy_data.students_k_11_deceased'],
                            ['text', 'Other', 'eoy_data.students_k_11_other'],
                            ['text', 'Unknown', 'eoy_data.students_k_11_unknown'],
                            
                            ['heading', 'Students in Grade 12', 'eoy_data.students_grade_12_graduated'],
                            ['text', 'Graduated', 'eoy_data.students_grade_12_graduated'],
                            ['text', 'Retained', 'eoy_data.students_grade_12_retained'],
                            ['text', 'Dropped Out', 'eoy_data.students_grade_12_dropped_out'],
                            ['text', 'Transferred', 'eoy_data.students_grade_12_transferred'],
                            ['text', 'GED', 'eoy_data.students_grade_12_ged'],
                            ['text', 'Expelled', 'eoy_data.students_grade_12_expelled'],
                            ['text', 'Incarcerated', 'eoy_data.students_grade_12_incarcerated'],
                            ['text', 'Deceased', 'eoy_data.students_grade_12_deceased'],
                            ['text', 'Other', 'eoy_data.students_grade_12_other'],
                            ['text', 'Unknown', 'eoy_data.students_grade_12_unknown'],
                        ]
                    })

        
    div(
        o-base="col--pStart rhy--yStart100"
    )  
        include /cards/data-list
            -
                vefa
                    .data({
                        heading: "School District Details",
                        map: [
                            ["text", "School District(s)",],
                            ["text", "Total Enrollment", 'eoy_data.total_enrollment'],
                            ["text", "Number of Case-managed Students", 'True', ' '],
                            ["text", "Total Students Reached", 'True', ' '],
                            ["heading", "Affiliate Staffing"],
                            ["text", "Full-time", page['current_data.full_time_staff'].io()],
                            ["text", "Part-time", page['current_data.part_time_staff'].io()],
                            ["text", "Americorps", page['current_data.americorps_staff'].io()],
                        ]
                    })
                    .define({
                        data_key: {
                            "o-condensed": "pad--x50 gxs--s2"
                        },
                        data_value: {
                            "o-condensed": "pad--x50"
                        }
                    })

        include /cards/data-list
            -
                vefa
                    .data({
                        heading: "By Race and Gender",
                        map: [
                            ['heading', 'Students By Race/ Ethnicity', 'eoy_data.search_race'],
                            ['text', 'American Indian', 'eoy_data.search_students_american_indian'],
                            ['text', 'Asian', 'eoy_data.search_students_asian'],
                            ['text', 'Black', 'eoy_data.search_students_black'],
                            ['text', 'Hispanic', 'eoy_data.search_students_hispanic'],
                            ['text', 'White', 'eoy_data.search_students_white'],
                            ['text', 'Two or More', 'eoy_data.search_students_two_or_more'],
                            ['text', 'Other', 'eoy_data.search_students_other'],
                            ['heading', 'Students By Gender', 'eoy_data.search_gender'],
                            ['text', 'Male', 'eoy_data.search_students_male'],
                            ['text', 'Female', 'eoy_data.search_students_female']
                        ]
                    })

        +if('eoy_data.total_students_served > 0')
            include /cards/data-list
                -
                    vefa
                        .data({
                            heading: "Demographics of Students Served",
                            map: [
                                ['yesno', 'FRPL Eligible Students Served', 'eoy_data.total_students_frpl > 0'],
                                ['yesno', 'ELL Students Served', 'eoy_data.total_students_ell > 0'],
                                ['yesno', 'Foster Care/Group Home', 'eoy_data.total_students_foster > 0'],
                                ['yesno', 'Homeless Youth', 'eoy_data.total_students_homeless > 0'],
                                ['yesno', 'LGBT', 'eoy_data.total_students_lgbt > 0'],
                                ['yesno', 'Pregnant/Parenting', 'eoy_data.total_students_pregnant_parenting > 0'],
                                ['yesno', 'Special Education', 'eoy_data.total_students_special_education > 0'],
                                ['yesno', 'Substance Abuse', 'eoy_data.total_students_substance_abuse > 0'],
                                ['yesno', 'Adjudicated Youth', 'eoy_data.total_students_adjudicated_youth > 0'],
                                ['yesno', 'Child of Military', 'eoy_data.total_students_child_of_military > 0'],
                                ['yesno', 'Gang Involvement', 'eoy_data.total_students_gang > 0'],
                                ['yesno', 'Incarcerated Parent', 'eoy_data.total_students_incarcerated_parent > 0'],
                            ]
                        })
                        .define({
                            data_key: {
                                "o-condensed": "pad--x50 gxs--s2"
                            },
                            data_value: {
                                "o-condensed": "pad--x50"
                            }
                        })

            
        